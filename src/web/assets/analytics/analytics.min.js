!function(t){"use strict";t.lrRedirectAnalyticsInit=function(e){const n=e||{};if(t.lrRedirectAnalyticsBound)return void(t.lrAnalyticsInit&&t.lrAnalyticsInit(n));t.lrRedirectAnalyticsBound=!0,t.lrAnalyticsInit&&t.lrAnalyticsInit(n);const a=t.lrChartColors||["#0d78f2","#10b981","#ef4444","#f59e0b","#8b5cf6","#06b6d4","#ec4899","#84cc16","#f97316","#6366f1","#14b8a6","#f43f5e"],l=n.strings||{},o=t.Craft&&Craft.getActionUrl&&n.dataEndpoint?Craft.getActionUrl(n.dataEndpoint):n.dataEndpoint;function r(t){if(!t)return;t.style.display="";const e=t.parentElement||t.parentNode;e&&e.querySelectorAll(".zilch").forEach(t=>t.remove())}function c(e,n,a){const l=document.getElementById(e);if(!l)return;r(l),function(e,n){const a=e.replace(/-/g,"_");t.lrChartInstances&&t.lrChartInstances[n]&&t.lrChartInstances[n][a]&&(t.lrChartInstances[n][a].destroy(),delete t.lrChartInstances[n][a])}(e,a),l.style.display="none";const o=document.createElement("div");o.className="zilch",o.style.padding="48px 24px",o.innerHTML="<p>"+n+"</p>",l.parentNode.appendChild(o)}function s(t,e,a,l){if(!o)return void(l&&l());const r=Object.assign({type:t},e||{});if(n.csrfName&&n.csrfToken&&(r[n.csrfName]=n.csrfToken),"undefined"!=typeof $&&$.ajax)return void $.ajax({url:o,type:"POST",dataType:"json",data:r,success:function(t){t&&t.success?a(t.data||null):l&&l()},error:function(){l&&l()}});const c=new FormData;Object.keys(r).forEach(function(t){c.append(t,r[t])}),fetch(o,{method:"POST",body:c}).then(function(t){return t.json()}).then(function(t){t&&t.success?a(t.data||null):l&&l()}).catch(function(){l&&l()})}function i(e,n){const a=document.getElementById("404-trend-chart");a&&(r(a),e&&e.length?t.lrCreateChart("404-trend-chart","line",{labels:e.map(t=>t.date),datasets:[{label:l.handledLabel||"Handled",data:e.map(t=>t.handled),borderColor:"#10B981",backgroundColor:"#10B981",tension:.1,fill:!1},{label:l.unhandledLabel||"Unhandled",data:e.map(t=>t.unhandled),borderColor:"#EF4444",backgroundColor:"#EF4444",tension:.1,fill:!1}]},{scales:{y:{beginAtZero:!0,ticks:{stepSize:1,precision:0}}},plugins:{legend:{position:"bottom",align:"center",labels:{usePointStyle:!0,pointStyle:"circle",padding:20}}}}):c("404-trend-chart",l.noTrend||"No trend data available.",n))}function d(e,n){const o=document.getElementById("bot-chart");if(!o)return;if(r(o),!(e&&e.chart&&e.chart.labels&&e.chart.labels.length))return void c("bot-chart",l.noBot||"No bot data available.",n);t.lrCreateChart("bot-chart","doughnut",{labels:e.chart.labels,datasets:[{data:e.chart.values,backgroundColor:[a[1],a[2]]}]},{plugins:{legend:{position:"bottom"}}});const s=document.getElementById("bot-percentage-text");s&&(s.innerHTML="<strong>"+e.botPercentage+"%</strong> "+(l.botTraffic||"of traffic is from bots"))}function u(e,n){const o=document.getElementById("device-chart");o&&(r(o),e&&e.labels&&e.labels.length?t.lrCreateChart("device-chart","doughnut",{labels:e.labels,datasets:[{data:e.values,backgroundColor:a.slice(0,e.labels.length)}]},{plugins:{legend:{position:"bottom"}}}):c("device-chart",l.noDevice||"No device data available.",n))}function b(e,n){const o=document.getElementById("browser-chart");o&&(r(o),e&&e.labels&&e.labels.length?t.lrCreateChart("browser-chart","bar",{labels:e.labels,datasets:[{label:l.redirectsLabel||"404s",data:e.values,backgroundColor:a[0],borderColor:a[0],borderWidth:1}]},{scales:{y:{beginAtZero:!0,ticks:{stepSize:1,precision:0}}},plugins:{legend:{display:!1}}}):c("browser-chart",l.noBrowser||"No browser data available.",n))}function f(e,n){const o=document.getElementById("os-chart");o&&(r(o),e&&e.labels&&e.labels.length?t.lrCreateChart("os-chart","doughnut",{labels:e.labels,datasets:[{data:e.values,backgroundColor:a}]},{plugins:{legend:{position:"bottom"}}}):c("os-chart",l.noOs||"No OS data available.",n))}document.addEventListener("lr:analyticsInit",function(e){const a=e.detail&&e.detail.config?e.detail.config:t.lrAnalyticsConfig||{};!function(t,e,n){const a={dateRange:t,siteId:e};s("chart",a,function(t){i(t||[],n)},function(){i([],n)}),s("bots",a,function(t){d(t||null,n)},function(){d(null,n)}),s("devices",a,function(t){u(t||null,n)},function(){u(null,n)}),s("browsers",a,function(t){b(t||null,n)},function(){b(null,n)}),s("os",a,function(t){f(t||null,n)},function(){f(null,n)})}(a.dateRange||n.dateRange||"last7days",a.siteId||n.siteId||"",a.prefix||"analytics")})}}(window);